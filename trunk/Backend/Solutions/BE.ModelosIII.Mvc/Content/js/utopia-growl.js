(function(a){a.widget("ech.notify",{options:{speed:500,expires:5000,stack:"below",custom:false,queue:false},_create:function(){var b=this;this.templates={};this.keys=[];this.element.addClass("ui-notify").children().addClass("ui-notify-message ui-notify-message-style").each(function(d){var c=this.id||d;b.keys.push(c);b.templates[c]=a(this).removeAttr("id").wrap("<div></div>").parent().html()}).end().empty().show()},create:function(c,e,d){if(typeof c==="object"){d=e;e=c;c=null}var b=this.templates[c||this.keys[0]];if(d&&d.custom){b=a(b).removeClass("ui-notify-message-style").wrap("<div></div>").parent().html()}this.openNotifications=this.openNotifications||0;return new a.ech.notify.instance(this)._create(e,a.extend({},this.options,d),b)}});a.extend(a.ech.notify,{instance:function(b){this.__super=b;this.isOpen=false}});a.extend(a.ech.notify.instance.prototype,{_create:function(h,e,g){this.options=e;var d=this,f=g.replace(/#(?:\{|%7B)(.*?)(?:\}|%7D)/g,function(i,j){return(j in h)?h[j]:""}),c=(this.element=a(f)),b=c.find(".ui-notify-close");if(typeof this.options.click==="function"){c.addClass("ui-notify-click").bind("click",function(i){d._trigger("click",i,d)})}if(b.length){b.bind("click",function(){d.close();return false})}this.__super.element.queue("notify",function(){d.open();if(typeof e.expires==="number"&&e.expires>0){setTimeout(a.proxy(d.close,d),e.expires)}});if(!this.options.queue||this.__super.openNotifications<=this.options.queue-1){this.__super.element.dequeue("notify")}return this},close:function(){var b=this.options.speed;this.element.fadeTo(b,0).slideUp(b,a.proxy(function(){this._trigger("close");this.isOpen=false;this.element.remove();this.__super.openNotifications-=1;this.__super.element.dequeue("notify")},this));return this},open:function(){if(this.isOpen||this._trigger("beforeopen")===false){return this}var b=this;this.__super.openNotifications+=1;this.element[this.options.stack==="above"?"prependTo":"appendTo"](this.__super.element).css({display:"none",opacity:""}).fadeIn(this.options.speed,function(){b._trigger("open");b.isOpen=true});return this},widget:function(){return this.element},_trigger:function(c,d,b){return this.__super._trigger.call(this,c,d,b)}})})(jQuery);